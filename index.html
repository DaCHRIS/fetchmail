<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>fetchmail by PF4Public</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>fetchmail</h1>
        <p>Roundcube Fetchmail Plugin</p>
        <p class="view"><a href="https://github.com/PF4Public/fetchmail">View the Project on GitHub <small>PF4Public/fetchmail</small></a></p>
        <ul>
          <li><a href="https://github.com/PF4Public/fetchmail/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/PF4Public/fetchmail/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/PF4Public/fetchmail">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="roundcube-fetchmail-plugin" class="anchor" href="#roundcube-fetchmail-plugin" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Roundcube fetchmail plugin</h1>

<p><strong>Roundcube fetchmail plugin</strong> is a <strong>Roundcube</strong> plugin, which allows users to download their mail from external mailboxes.</p>

<h2>
<a id="screenshot" class="anchor" href="#screenshot" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Screenshot</h2>

<p><img src="http://pf4public.github.io/fetchmail/images/scrn.PNG" alt="Screenshot"></p>

<h2>
<a id="prerequisites" class="anchor" href="#prerequisites" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Prerequisites</h2>

<ol>
<li><strong>Roundcube</strong></li>
<li>Database (<strong>PostgreSQL</strong> or <strong>MySQL</strong>)</li>
<li>
<strong>fetchmail</strong> itself</li>
<li>
<strong>Postfix Admin</strong> provides convenient <code>fetchmail.pl</code> script</li>
</ol>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<ol>
<li>First you need to install <strong>fetchmail</strong> itself. For <strong>Debian</strong> you can do so by <code>sudo apt-get install fetchmail</code>
</li>
<li>Next you should extract <strong>Roundcube fetchmail plugin</strong> archive into your <strong>Roundcube</strong> <code>plugins</code> folder creating "fetchmail" folder there.

<ul>
<li>You can do so either by using <code>composer</code> for which there is <code>composer.json</code>, still you need to follow further installation steps since those could not be accomplished with <code>composer</code>
</li>
<li>Alternatively you can download needed release from <a href="https://github.com/PF4Public/fetchmail/releases">Releases page</a> unpacking it accordingly</li>
</ul>
</li>
<li>
<p>After that you need to enable newly installed plugin by adding it to <strong>Roundcube</strong> plugin list. For <strong>Debian</strong> related config file is <code>/etc/roundcube/main.inc.php</code> and relevant setting is </p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$rcmail_config</span> [<span class="pl-s"><span class="pl-pds">'</span>plugins<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-c1">array</span>();</span>
<span class="pl-s1"></span></pre></div>

<p>Appending <code>, 'fetchmail'</code> to the list of plugins will suffice.</p>
</li>
<li>Unless default settings are suitable for you, you need to configure the plugin. See the <a href="#settings">settings section</a> for more information.</li>
<li>You need to create additional table in your database using one of the supplied <code>.sql</code> files. Another possibility is to use <strong>Postfix Admin</strong> table if you have it installed. If using <strong>PostgreSQL</strong> you may use schemas to share <code>fetchmail</code> table between <strong>Roundcube</strong> and <strong>Postfix Admin</strong>. Namely creating it in <code>public</code> schema, whereas every other table in it's appropriate schema, like <code>roundcube</code> and <code>postfixadmin</code>. Please refer to <a href="http://www.postgresql.org/docs/current/static/ddl-schemas.html">the documentation</a> for more information.</li>
<li>You will need <code>fetchmail.pl</code> script from <strong>Postfix Admin</strong> distribution. If you don't have <strong>Postfix Admin</strong> installed, you can obtain required <code>fetchmail.pl</code> script from their repo  <a href="https://sourceforge.net/p/postfixadmin/code/HEAD/tree/trunk/ADDITIONS/fetchmail.pl">trunk / ADDITIONS / fetchmail.pl</a>. But be sure to get at least revision <a href="https://sourceforge.net/p/postfixadmin/code/1766/">[r1766]</a>, at which proper handling of <code>active</code> field introduced. Place it to where apropriate. For example, where your mailboxes are, e.g. <code>/var/mail</code>.</li>
<li>
<p>Next adapt <code>fetchmail.pl</code> to your config. Most likely you want to change these settings:</p>

<div class="highlight highlight-source-perl"><pre><span class="pl-c"># database backend - uncomment one of these</span>
<span class="pl-k">our</span> <span class="pl-smi">$db_type</span> = <span class="pl-s"><span class="pl-pds">'</span>Pg<span class="pl-pds">'</span></span>;
<span class="pl-c">#my $db_type = 'mysql';</span>

<span class="pl-c"># host name</span>
<span class="pl-k">our</span> <span class="pl-smi">$db_host</span>=<span class="pl-s"><span class="pl-pds">"</span>127.0.0.1<span class="pl-pds">"</span></span>;
<span class="pl-c"># database name</span>
<span class="pl-k">our</span> <span class="pl-smi">$db_name</span>=<span class="pl-s"><span class="pl-pds">"</span>postfix<span class="pl-pds">"</span></span>;
<span class="pl-c"># database username</span>
<span class="pl-k">our</span> <span class="pl-smi">$db_username</span>=<span class="pl-s"><span class="pl-pds">"</span>mail<span class="pl-pds">"</span></span>;
<span class="pl-c"># database password</span>
<span class="pl-k">our</span> <span class="pl-smi">$db_password</span>=<span class="pl-s"><span class="pl-pds">"</span>CHANGE_ME!<span class="pl-pds">"</span></span>;</pre></div>
</li>
<li>Next step is to configure <strong>cron</strong> for regular mail checking with <code>sudo crontab -u mail -e</code>. For example for 5 minute intervals add this: <code>*/5 * * * * /var/mail/fetchmail.pl &gt;/dev/null</code>. Worth noting that even if you configure cron for a 5 minutes interval, fetchmail will still abide user configured checking interval. As a result setting bigger intervals here manifests them as intervals available to fetchmail, that is setting <code>0 * * * *</code> here overrides any user setting wich is less then hour</li>
<li>You might also need to install <code>liblockfile-simple-perl</code> and ( <code>libsys-syslog-perl</code> or <code>libunix-syslog-perl</code> ) on <strong>Debian</strong>-based systems.</li>
<li>Lastly there might be need to do <code>sudo mkdir /var/run/fetchmail; sudo chown mail:mail /var/run/fetchmail</code>
</li>
</ol>

<h2>
<a id="settings" class="anchor" href="#settings" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Settings</h2>

<p>In case you need to edit default-set settings, you may copy <code>config.inc.php.dist</code> to <code>config.inc.php</code> and edit setings as desired in the latter file, which will overrride defaults.</p>

<ul>
<li>
<code>$rcmail_config ['fetchmail_limit']</code> limits the number of external mailboxes per user allowed. Default is <code>10</code>.</li>
<li>
<code>$rcmail_config ['fetchmail_folder']</code> whether to allow users to specify IMAP folder they wish to download mail from. Default is <code>false</code>.</li>
<li>
<code>$rcmail_config ['fetchmail_mda']</code> allows you to specify mda field for fetchmail. This could be useful in case you want to deliver downloaded mail via MDA or LDA directly, rather than forwarding via SMTP or LMTP. For more information please refer to <a href="http://www.fetchmail.info/fetchmail-man.html">fetchmail manual</a> and <a href="https://sourceforge.net/p/postfixadmin/code/HEAD/tree/trunk/ADDITIONS/fetchmail.pl">fetchmail.pl</a> script. Default is <code>''</code>, i.e. not used.</li>
</ul>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h2>

<p>This software distributed under the terms of the GNU General Public License as published by the Free Software Foundation</p>

<p>Further details on the GPL license can be found at <a href="http://www.gnu.org/licenses/gpl.html">http://www.gnu.org/licenses/gpl.html</a></p>

<p>By contributing to <strong>Roundcube fetchmail plugin</strong>, authors release their contributed work under this license</p>

<h2>
<a id="acknowledgements" class="anchor" href="#acknowledgements" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Acknowledgements</h2>

<h3>
<a id="original-author" class="anchor" href="#original-author" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Original author</h3>

<p>Arthur Mayer, <a href="https://github.com/flames">https://github.com/flames</a></p>

<h3>
<a id="list-of-contributors" class="anchor" href="#list-of-contributors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>List of contributors</h3>

<p>For a complete list of contributors, refer to <a href="https://github.com/PF4Public/fetchmail/graphs/contributors">Github project contributors page</a></p>

<h4>
<a id="currently-maintained-by" class="anchor" href="#currently-maintained-by" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Currently maintained by</h4>

<ul>
<li><a href="https://github.com/PF4Public">PF4Public</a></li>
</ul>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/PF4Public">PF4Public</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
